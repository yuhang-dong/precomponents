---
import { parseDocsFromSectionAndEntries } from "../../utils/storybookEntriesUtils";

export async function getStaticPaths() {
  const mode = await import("virtual:storybook-index");
  const indexEndpoint = mode?.value;
  const sections = Array.from(
    new Set(
      Object.values(indexEndpoint.entries).map(entry =>
        entry.title.includes("/") ? entry.title.split("/")[0] : "home"
      )
    )
  );
  return sections.map(section => ({ params: { section } }));
}

const { section } = Astro.params;
const mode = await import("virtual:storybook-index");
const indexEndpoint = mode?.value;
const docs = parseDocsFromSectionAndEntries(section, indexEndpoint.entries);
const firstDoc = docs[0];
if (firstDoc) {
  return Astro.redirect(`/${section}/${firstDoc.id}`);
}
---
<section style="padding: 48px; text-align: center;">
  <h2>该 Section 暂无文档</h2>
</section>